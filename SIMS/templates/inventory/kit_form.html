{% extends 'base/base.html' %}

{% block content %}
    <style>
		.form-piece_kit-group {
			border-bottom: 1px solid black;
		}
		.hidden {
			display: none
		}
	</style>
<h1>Add New Assembly</h1>
  <br/><br/>

  <form method="post"  id="form" data-second_location-url="{% url 'ajax_load_second_location' %}"
        data-third_location-url="{% url 'ajax_load_third_location' %}"
        data-fourth_location-url="{% url 'ajax_load_fourth_location' %}"
        data-fifth_location-url="{% url 'ajax_load_fifth_location' %}"
        data-sixth_location-url="{% url 'ajax_load_sixth_location' %}"
        data-seventh_location-url="{% url 'ajax_load_seventh_location' %}"
        data-eighth_location-url="{% url 'ajax_load_eighth_location' %}"
        action="#" enctype="multipart/form-data" novalidate>
  {% csrf_token %}
    <h3>General Information</h3>
    <div class="form-general-group">
      <label for="group_assembly" class="control-label mb-1">Group Assembly</label>
      {{ form.group_assembly }}
    </div>
    <div class="form-general-group">
      <label for="name" class="control-label mb-1">Name</label>
      {{ form.name }}
    </div>
    <div class="form-general-group">
      <label for="description" class="control-label mb-1">Description</label>
      {{ form.description }}
    </div>
    <div class="form-general-group">
      <label for="kit_serialnumber" class="control-label mb-1">CAE Serial Number</label>
      {{ form.kit_serialnumber }}
    </div>
    <div class="form-general-group">
      <label for="update_comment" class="control-label mb-1">Comment</label>
      {{ form.update_comment }}
    </div>
    <div class="form-general-group">
      <label for="kit_status" class="control-label mb-1">Status</label>
      {{ form.kit_status }}
    </div>
    <h3>Location management</h3>
    <div class="form-general-group">
      <label for="first_location" class="control-label mb-1">Level 1</label>
      {{ form.first_location }}
    </div>
    <div class="form-general-group">
      <label for="second_location" class="control-label mb-1">Level 2</label>
      {{ form.second_location }}
    </div>
    <div class="form-general-group">
      <label for="third_location" class="control-label mb-1">Level 3</label>
      {{ form.third_location }}
    </div>
    <div class="form-general-group">
      <label for="fourth_location" class="control-label mb-1">Level 4</label>
      {{ form.fourth_location }}
    </div>
    <div class="form-general-group">
      <label for="fifth_location" class="control-label mb-1">Level 5</label>
      {{ form.fifth_location }}
    </div>
    <div class="form-general-group">
      <label for="sixth_location" class="control-label mb-1">Level 6</label>
      {{ form.sixth_location }}
    </div>
    <div class="form-general-group">
      <label for="seventh_location" class="control-label mb-1">Level 7</label>
      {{ form.seventh_location }}
    </div>
    <div class="form-general-group">
      <label for="eighth_location" class="control-label mb-1">Level 8</label>
      {{ form.eighth_location }}
    </div>
    <h3>Instance management</h3>
    <div id="piece_kit-1" class="form-piece_kit-group">
      <label for="piece_kit_1" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_1 }}
    </div>
    <div id="piece_kit-2" class="form-piece_kit-group">
      <label for="piece_kit_2" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_2 }}
    </div>
    <div id="piece_kit-3" class="hidden">
      <label for="piece_kit_3" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_3 }}
    </div>
    <div id="piece_kit-4"  class="hidden">
      <label for="piece_kit_4" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_4 }}
    </div>
    <div id="piece_kit-5"  class="hidden">
      <label for="piece_kit_5" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_5 }}
    </div>
    <div id="piece_kit-6"  class="hidden">
      <label for="piece_kit_6" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_6 }}
    </div>
    <div id="piece_kit-7"  class="hidden">
      <label for="piece_kit_7" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_7 }}
    </div>
    <div id="pieceeq-8"  class="hidden">
      <label for="piece_kit_8" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_8 }}
    </div>
    <div id="piece_kit-9"  class="hidden">
      <label for="piece_kit_9" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_9 }}
    </div>
    <div id="piece_kit-10"  class="hidden">
      <label for="piece_kit_10" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_10 }}
    </div>
    <div id="piece_kit-11"  class="hidden">
      <label for="piece_kit_11" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_11 }}
    </div>
    <div id="piece_kit-12"  class="hidden">
      <label for="piece_kit_12" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_12 }}
    </div>
    <div id="piece_kit-13"  class="hidden">
      <label for="piece_kit_13" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_13 }}
    </div>
    <div id="piece_kit-14"  class="hidden">
      <label for="piece_kit_14" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_14 }}
    </div>
    <div id="piece_kit-15"  class="hidden">
      <label for="piece_kit_15" class="control-label mb-1">Choose Instance</label>
      {{ form.piece_kit_15 }}
    </div>
    <div>
      <button id="add-more" type="button"> Add more </button>
      <button id="submit-button" type="submit" class="btn btn-lg btn-info btn-block">
        <span id="submit-button-amount">Create Assembly</span>
      </button>
    </div>
  </form>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script>
	// To understand this section : https://www.youtube.com/watch?v=s3T-w2jhDHE&list=PLEsfXFp6DpzRMby_cSoWTFw8zaMdTEXgL&index=64
	const addMoreBtn = document.getElementById("add-more")
	const totalNewForms = document.getElementById("piece_kit-TOTAL_FORMS")
	addMoreBtn.addEventListener('click', add_new_form)

	function add_new_form(event) {
		// we prevent java console from populating (adding traffic)
		if (event) {
			event.preventDefault()
		}
		const currentPieceinstanceForms = document.getElementsByClassName("form-piece_kit-group")
		console.log(currentPieceinstanceForms)
		let currentFormCount = currentPieceinstanceForms.length
		// we want the new form to appear after the last loaded form
		const formCopyTarget = document.getElementById(`piece_kit-${currentFormCount+1}`)
		console.log(formCopyTarget)
		// now add new empty form element to our html form
		formCopyTarget.setAttribute('class', 'form-piece_kit-group')
	}
  </script>


  <script>
    $("#id_first_location").change(function () {
      var url = $("#form").attr("data-second_location-url");  // get the url of the `load_second_location` view
      var previous_locId = $(this).val();  // get the selected previous_loc ID from the HTML input

      $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-second_location/)
        data: {
          'previous_loc': previous_locId       // add the previous_loc id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_second_location` view function
          $("#id_second_location").html(data);  // replace the contents of the second_location input with the data that came from the server
        }
      });

    });
  </script>
  <script>
    $("#id_second_location").change(function () {
      var url = $("#form").attr("data-third_location-url");  // get the url of the `load_second_location` view
      var previous_locId = $(this).val();  // get the selected previous_loc ID from the HTML input

      $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-second_location/)
        data: {
          'previous_loc': previous_locId       // add the previous_loc id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_second_location` view function
          $("#id_third_location").html(data);  // replace the contents of the second_location input with the data that came from the server
        }
      });

    });
  </script>
  <script>
    $("#id_third_location").change(function () {
      var url = $("#form").attr("data-fourth_location-url");  // get the url of the `load_second_location` view
      var previous_locId = $(this).val();  // get the selected previous_loc ID from the HTML input

      $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-second_location/)
        data: {
          'previous_loc': previous_locId       // add the previous_loc id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_second_location` view function
          $("#id_fourth_location").html(data);  // replace the contents of the second_location input with the data that came from the server
        }
      });

    });
  </script>
  <script>
    $("#id_fourth_location").change(function () {
      var url = $("#form").attr("data-fifth_location-url");  // get the url of the `load_second_location` view
      var previous_locId = $(this).val();  // get the selected previous_loc ID from the HTML input

      $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-second_location/)
        data: {
          'previous_loc': previous_locId       // add the previous_loc id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_second_location` view function
          $("#id_fifth_location").html(data);  // replace the contents of the second_location input with the data that came from the server
        }
      });

    });
  </script>
  <script>
    $("#id_fifth_location").change(function () {
      var url = $("#form").attr("data-sixth_location-url");  // get the url of the `load_second_location` view
      var previous_locId = $(this).val();  // get the selected previous_loc ID from the HTML input

      $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-second_location/)
        data: {
          'previous_loc': previous_locId       // add the previous_loc id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_second_location` view function
          $("#id_sixth_location").html(data);  // replace the contents of the second_location input with the data that came from the server
        }
      });

    });
  </script>
  <script>
    $("#id_sixth_location").change(function () {
      var url = $("#form").attr("data-seventh_location-url");  // get the url of the `load_second_location` view
      var previous_locId = $(this).val();  // get the selected previous_loc ID from the HTML input

      $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-second_location/)
        data: {
          'previous_loc': previous_locId       // add the previous_loc id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_second_location` view function
          $("#id_seventh_location").html(data);  // replace the contents of the second_location input with the data that came from the server
        }
      });

    });
  </script>
  <script>
    $("#id_seventh_location").change(function () {
      var url = $("#form").attr("data-eighth_location-url");  // get the url of the `load_second_location` view
      var previous_locId = $(this).val();  // get the selected previous_loc ID from the HTML input

      $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-second_location/)
        data: {
          'previous_loc': previous_locId       // add the previous_loc id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_second_location` view function
          $("#id_eighth_location").html(data);  // replace the contents of the second_location input with the data that came from the server
        }
      });

    });
  </script>
{% endblock %}